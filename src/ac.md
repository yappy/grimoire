# 交流

## 実数

交流電源電圧 (単位は V: ボルト) を

\\[
  V(t) = V_0 \sin (\omega t + \phi)
\\]

とする。

* \\( V_0 \\): 振幅 (V)
  * 三角関数は -1 から 1 の間を振動するので、電圧は
    \\( - V_0 \leq V(t) \leq V_0 \\) の間を振動する。
* \\( \omega \\): 角周波数 (rad/s)
  * 時刻を角度に変換する比例定数。振動の速さを表す。
* \\( t \\): 時刻 (s)
* \\( \phi \\): 初期位相 (rad)
  * 三角関数の中身 (rad) のことを位相と呼ぶ。
    位相は時間的な位置を角度の単位で表したもの。
  * 初期位相は \\( t = 0 \\) のときの位相のこと。

角周波数と周期、周波数について。
どれか1つが決まれば他もすべて自動的に決まる。

* \\( \omega \\): 角周波数 (rad/s)
  * 1秒間に位相が何 rad 進むか。
* \\( T \\): 周期 (T)
  * 振動が1回にかかる時間。
* \\( f \\): 周波数 (Hz = 1/s)
  * 1秒に何回振動するか。

三角関数は位相が 360 度進むと一周する。
角速度 \\( \omega \\) (rad/s) で角度 \\( 2 \pi \\) (rad) を進むのにかかる時間が
周期 \\( T \\) (s) である。

\\[
\begin{eqnarray}
  \omega T = 2 \pi \\\\
  T = \frac{ 2 \pi }{ \omega } \\\\
\end{eqnarray}
\\]

周期と周波数は逆数の関係にある。

\\[
\begin{eqnarray}
  f &=& \frac{ 1 }{ T } \\\\
  T &=& \frac{ 1 }{ f } \\\\
\end{eqnarray}
\\]

以上で困ることはないはずだが、以下の表式は他の式から導くのではなく覚えておくと便利。

\\[
\begin{eqnarray}
  \omega &=& 2 \pi f \\\\
  V(t) &=& V_0 \sin (2 \pi f t + \phi) \\\\
\end{eqnarray}
\\]

### 抵抗

\\[
\begin{eqnarray}
  V(t) &=& R I(t) \\\\
  I(t) &=& \frac{ 1 }{ R } V(t) \\\\
  &=& \frac{ 1 }{ R } V_0 \sin (\omega t + \phi) \\\\
\end{eqnarray}
\\]

### コンデンサ

\\[
  Q(t) = C V(t)
\\]

コンデンサに流れ込む電流 (A = C/s) がコンデンサに蓄えられた電荷 (C) の
単位時間あたりの増加量であるので、

\\[
\begin{eqnarray}
  I(t) &=& \frac{ d }{ dt } Q(t) \\\\
  &=& C V'(t) \\\\
  &=& \omega C V_0 \cos (\omega t + \phi) \\\\
  &=& \omega C V_0 \sin (\omega t  +\phi + 90^{\circ}) \\\\
\end{eqnarray}
\\]

* 電圧に比べて電流は位相は 90 度(1/4 周期) 進んでいる。
* 位相差は実数では取り扱いにくいので、一旦無視して電圧と電流の振幅の比から
  「抵抗のようなもの」を考える。これを (容量性) **リアクタンス** という。
  電圧/電流なので単位はオーム。

\\[
\begin{eqnarray}
  I_0 &=& \omega C V_0  \\\\
  V_0 &=& X_C I_0 \\\\
  X_C &=& \frac{ V_0 }{ I_0 } \\\\
  &=& \frac{ 1 }{\omega C} \\\\
\end{eqnarray}
\\]

* 静電容量が大きいほどリアクタンスは小さい。
  コンデンサの容量が大きいほど大きな電流が流れる。
* 角周波数が大きいほどリアクタンスは小さい。
  頻繁に充放電の方向が切り替わると、大きな電流が流れる。

### コイル

\\[
  V(t) = L \frac{ d }{ dt } I(t)
\\]
(符号に注意。キルヒホッフの法則で電圧の和が 0 になる式を立てる時に
コイルの起電力がマイナスになる。)

両辺を t で積分して (積分定数の処理が面倒だがどうせ 0 になる)

\\[
\begin{eqnarray}
  \int V(t) dt &=& L I(t) \\\\
  I(t) &=& \frac{ 1 }{ L } \int V(t) dt \\\\
  &=& - \frac{ 1 }{ \omega L } V_0 \cos (\omega t + \phi) \\\\
  &=& \frac{ 1 }{ \omega L } V_0 \sin (\omega t + \phi - 90^{\circ}) \\\\
\end{eqnarray}
\\]

* 電圧に比べて電流は位相は 90 度(1/4 周期) 遅れている。
* コンデンサと同様に位相差は一旦無視して電圧と電流の振幅の比から
  「抵抗のようなもの」を考える。これを (誘導性) **リアクタンス** という。
  電圧/電流なので単位はオーム。

\\[
\begin{eqnarray}
  I_0 &=& \frac{ 1 }{ \omega L } V_0  \\\\
  V_0 &=& X_L I_0 \\\\
  X_L &=& \frac{ V_0 }{ I_0 } \\\\
  &=& \omega L \\\\
\end{eqnarray}
\\]

* 自己インダクタンスが大きいほどリアクタンスは大きい。
  コイルが強いほど、電流は流れにくくなる。
* 角周波数が大きいほどリアクタンスは大きい。
  頻繁に電圧の正負が切り替わって電流を激しく変化させようとすると、
  コイルに激しく抵抗されて電流は小さくなる。

### RLC 直列回路

交流電源にコイルやコンデンサを1つだけつないだ場合は微分または積分を1回行うだけで
何とかなったが、実際の回路はそれをいくつもつなげるわけで、
対応できるかちょっと不安になってくる。
RLC を直列に並べたときの電圧のつり合いを考えると、

\\[
  R I(t) + L \frac{ d }{ dt } I(t) + \frac{ 1 }{ C } Q(t) = V(t)
\\]

両辺 t で微分して Q を I に揃える。

\\[
\begin{eqnarray}
  R I'(t) + L I''(t) + \frac{ 1 }{ C } I(t) &=& V'(t) \\\\
  R I'(t) + L I''(t) + \frac{ 1 }{ C } I(t) &=&
  \omega V_0 \cos (\omega t + \phi) \\\\
  I'' + \frac{R}{L} I' + \frac{1}{LC} I &=&
  \frac{\omega V_0}{L} \cos (\omega t + \phi) \\\\
\end{eqnarray}
\\]

これは I(t) に関する二階線形微分方程式 (非斉次, 非同次) になっている。
実際にやると結構大変だが、解き方は確立されているので
その通りにやれば解けるといえば解ける。

* 右辺を 0 とした同次形を解く。
* 非同次形の特解を何か1つ気合で見つける。
* 上記2つを足したものが非同次形の一般解となる。

とにかく右辺が 0 になっていないところが苦しい (0 ならば比較的簡単に解ける) ので、
右辺を消すことを考える。
ここで、苦しいもののなんとか特解を1つでも見つけることができれば、
辺々引き算することで右辺を 0 にすることができる。

同次形は特性方程式を解き、2つの指数関数の線形和が一般解になる。
問題は非同次形の特解を求めるところで、今回はここが三角関数になっているケースであるので、
攻略法を調べて特解は \\( A \sin \omega t + B \cos \omega t \\) という形に
なるらしいという情報からいい感じに係数を決定してやる。

このように、解けると言えば解けるのだがはっきり言って結構大変なため、
もっと簡単な方法を導入する。

## 複素数

事情により、まず sin を cos にしておく。
sin も cos も同じ形の関数で位相が 1/4 周期ずれているだけなので、
この差は初期位相 \\( \phi \\) の部分に吸収されるため、どちらでもよい。

\\[
  V(t) = V_0 \cos (\omega t + \phi)
\\]

t-V グラフのまま考えるのは筋が悪いので、2次元平面での等速円運動を考える。

\\[
\begin{eqnarray}
  V(t) = x(t) &=& V_0 \cos (\omega t + \phi) \\\\
  y(t) &=& V_0 \sin (\omega t + \phi) \\\\
  r &=& V_0 \\\\
  \theta(t) &=& \omega t + \phi \\\\
\end{eqnarray}
\\]

y 座標を追加することで角速度一定の円運動としてとらえられるようにした。
すると、円運動なので極座標で考えると半径が定数関数、角度が一次関数になり、
より簡単に表せるようになる。
ここから y 座標を無視したもの (x 軸への射影) が電源電圧であると考える。

y 座標は極座標へ持ち込むために人為的に追加したものであるので、
逆に言えば何でもいいということにもなる。
極座標と言えば複素平面なので、y 軸を虚軸とし、また、オイラーの公式により
三角関数による複素平面での xy 直交座標表示と指数関数による極座標表示が等しい。
虚数単位として i を使ってしまうと電流と混同する危険があるので、次の文字である
j を使う。

\\[
\begin{eqnarray}
  \dot{V}(t) &=& x(t) + j y(t) \\\\
  &=& r e^{ j \theta(t) } \\\\
  x(t) &=& V_0 \cos (\omega t + \phi) \\\\
  y(t) &=& V_0 \sin (\omega t + \phi) \\\\
  r &=& V_0 \\\\
  \theta(t) &=& \omega t + \phi \\\\
\end{eqnarray}
\\]

電圧に y 座標を虚部として追加した **複素電圧** を導入した。
上部のドットは複素数であることを示す印である(逆にドットの無いものは実数である)。
この虚部は複素平面上での等速円運動ととらえるために計算の都合で追加したもので、
現実に観測される電圧電流とは関係がない。

具体的に代入すると

\\[
\begin{eqnarray}
  \dot{V}(t) &=& V_0 e^{ j (\omega t + \phi) } \\\\
  &=& V_0 e^{ j \phi } e^{ j \omega t } \\\\
  &=& \dot{V}_0 e^{ j \omega t } \\\\
  \dot{V}_0 &=& V_0 e^{ j \phi } \\\\
\end{eqnarray}
\\]

\\( \dot{V}_0 \\) には振幅と初期位相の情報を1つの複素数に埋め込んでいる。
長さが振幅 \\( V_0 \\) に等しい棒を、
初期位相 \\( \phi \\) の角度だけ回転させたものになっている。
それを \\( \omega t \\) だけさらに回転させたものが時刻 t における複素電圧である。

複素電圧から実際に観測される電圧を取り出すには、y 座標 (虚部) を無視して
x 座標 (実部) だけを取り出せばよい。

\\[
\begin{eqnarray}
  V(t) = x(t) &=& \mathrm{Re} (\dot{V}(t)) \\\\
  &=& V_0 \cos (\omega t + \phi) \\\\
\end{eqnarray}
\\]

### コンデンサ (複素数)

コンデンサの電流を求める式の電圧を複素電圧に置き換えてみる。
複素数の微分の実数倍だから、電流も複素数になる。
実際に観測される電流はこの実部である。
オイラーの功績により複素数の微分積分は実数の場合と全く同じ法則が成り立ち、
指数関数の微分なので三角関数より楽である。

\\[
\begin{eqnarray}
  \dot{I}(t) &=& C \dot{V}'(t) \\\\
  &=& C (\dot{V}_0 e^{ j \omega t })' \\\\
  &=& j \omega C \dot{V}_0 e^{ j \omega t } \\\\
  &=& j \omega C \dot{V}(t) \\\\
\end{eqnarray}
\\]

複素電圧と複素電流が (虚数単位が含まれることを受け入れれば)
定数倍の関係になっているので、
その比から「抵抗っぽいもの」を求めることができる。
複素数を複素数で割るので複素数になる。

\\[
\begin{eqnarray}
  \dot{Z}_C &=& \frac{ \dot{V}(t) }{ \dot{I}(t) } \\\\
  &=& \frac{1}{ j \omega C } \\\\
\end{eqnarray}
\\]

これを (複素) **インピーダンス** と呼ぶ。

\\[
\begin{eqnarray}
  \dot{V}(t) &=& \dot{Z}_C \dot{I}(t) \\\\
  \dot{I}(t) &=& \frac{1}{ \dot{Z}_C } \dot{V}(t) \\\\
\end{eqnarray}
\\]

電流と電圧を複素化し、その比も抵抗を複素化したもの (インピーダンス) とみなすことで、
オームの法則の自然な拡張となっている。
インピーダンスの極形式での絶対値と偏角をみると、

\\[
\begin{eqnarray}
  |\dot{Z}_C| &=& \frac{1}{ \omega C } \\\\
  \arg (\dot{Z}_C) &=& -90^{\circ}
\end{eqnarray}
\\]

* 複素数の掛け算は絶対値の掛け算と偏角の足し算
* 複素数の割り算は絶対値の割り算と偏角の引き算

\\[
\begin{eqnarray}
  r_1 e^{ j \theta_1 } \cdot r_2 e^{ j \theta_2 }
  &=& (r_1 r_2 ) e^{ j (\theta_1 + \theta_2) } \\\\
  &=& r_3 e^{ j \theta_3 } \\\\
  r_3 &=& r_1 r_2 \\\\
  \theta_3 &=& \theta_1 + \theta_2 \\\\
\end{eqnarray}
\\]

だから、

* インピーダンスの絶対値は電圧と電流の振幅の比を表す。
  * これはリアクタンスに等しい。
* インピーダンスの偏角は電圧と電流の位相の差を表す。

実数では位相差の話は難しいので諦めて振幅の比のみをリアクタンスとして求めたが、
複素インピーダンスには振幅の比に加えて位相差の情報も同時に含めることに成功している。

電圧から電流を求めるためにはインピーダンスを掛けるのではなくインピーダンスで
割らなければならないことに注意して、

* 角周波数や静電容量が大きいと電流の振幅はそれに比例して大きくなる。
* 電流の位相は 90 度早まる。

ことが分かる。
これは実数の範囲で微積で求めた結果と一致する。

### コイル (複素数)

\\[
\begin{eqnarray}
  L \dot{I}'(t) &=& \dot{V}(t) \\\\
  L \dot{I}(t) &=& \int \dot{V}(t) dt \\\\
  \dot{I}(t) &=& \frac{1}{L} \int \dot{V}_0 e^{ j \omega t } dt \\\\
  &=& \frac{1}{ j \omega L } \dot{V}_0 e^{ j \omega t } \\\\
  &=& \frac{1}{ j \omega L } \dot{V}(t) \\\\
\end{eqnarray}
\\]

コイルも同じく電圧と電流が複素数の世界で比例関係になり、

\\[
\begin{eqnarray}
  \dot{Z}_L &=& \frac{ \dot{V}(t) }{ \dot{I}(t) } \\\\
  &=& j \omega L \\\\
\end{eqnarray}
\\]

\\[
\begin{eqnarray}
  |\dot{Z}_L| &=& \omega L \\\\
  \arg (\dot{Z}_L) &=& +90^{\circ}
\end{eqnarray}
\\]
